#!/bin/bash

# Mark all old remote migrations as reverted
echo "Marking old remote migrations as reverted..."

npx supabase migration repair --status reverted 20250627043207
npx supabase migration repair --status reverted 20250627043215
npx supabase migration repair --status reverted 20250627043224
npx supabase migration repair --status reverted 20250627043232
npx supabase migration repair --status reverted 20250627050122
npx supabase migration repair --status reverted 20250627134915
npx supabase migration repair --status reverted 20250627135713
npx supabase migration repair --status reverted 20250628191257
npx supabase migration repair --status reverted 20250628192536
npx supabase migration repair --status reverted 20250628205017
npx supabase migration repair --status reverted 20250628205406
npx supabase migration repair --status reverted 20250628214620
npx supabase migration repair --status reverted 20250628214857
npx supabase migration repair --status reverted 20250628215314
npx supabase migration repair --status reverted 20250628215457
npx supabase migration repair --status reverted 20250628220246
npx supabase migration repair --status reverted 20250628220514
npx supabase migration repair --status reverted 20250628222525
npx supabase migration repair --status reverted 20250628235352
npx supabase migration repair --status reverted 20250629032559
npx supabase migration repair --status reverted 20250629040423
npx supabase migration repair --status reverted 20250629043623
npx supabase migration repair --status reverted 20250629163407
npx supabase migration repair --status reverted 20250701163635
npx supabase migration repair --status reverted 20250701163940
npx supabase migration repair --status reverted 20250701164552
npx supabase migration repair --status reverted 20250701174644
npx supabase migration repair --status reverted 20250701174809
npx supabase migration repair --status reverted 20250702001529
npx supabase migration repair --status reverted 20250702003033
npx supabase migration repair --status reverted 20250704180943
npx supabase migration repair --status reverted 20250704181408
npx supabase migration repair --status reverted 20250704181930
npx supabase migration repair --status reverted 20250704183830
npx supabase migration repair --status reverted 20250704184601
npx supabase migration repair --status reverted 20250707025630
npx supabase migration repair --status reverted 20250707030829
npx supabase migration repair --status reverted 20250707161132
npx supabase migration repair --status reverted 20250707164928
npx supabase migration repair --status reverted 20250707165643
npx supabase migration repair --status reverted 20250707173041
npx supabase migration repair --status reverted 20250707174336
npx supabase migration repair --status reverted 20250707174427
npx supabase migration repair --status reverted 20250707175159
npx supabase migration repair --status reverted 20250707175826
npx supabase migration repair --status reverted 20250707184331
npx supabase migration repair --status reverted 20250707192205
npx supabase migration repair --status reverted 20250707193555
npx supabase migration repair --status reverted 20250707194530
npx supabase migration repair --status reverted 20250708000451
npx supabase migration repair --status reverted 20250708022358
npx supabase migration repair --status reverted 20250708025949
npx supabase migration repair --status reverted 20250708032947
npx supabase migration repair --status reverted 20250715153000
npx supabase migration repair --status reverted 20250715160000
npx supabase migration repair --status reverted 20250716013503
npx supabase migration repair --status reverted 20250716030946
npx supabase migration repair --status reverted 20250716060844
npx supabase migration repair --status reverted 20250716115920
npx supabase migration repair --status reverted 20250717061800
npx supabase migration repair --status reverted 20250717061948
npx supabase migration repair --status reverted 20250719000000
npx supabase migration repair --status reverted 20250720003712
npx supabase migration repair --status reverted 20250721011654
npx supabase migration repair --status reverted 20250721011710
npx supabase migration repair --status reverted 20250721012105
npx supabase migration repair --status reverted 20250721012118
npx supabase migration repair --status reverted 20250721012129
npx supabase migration repair --status reverted 20250721012527
npx supabase migration repair --status reverted 20250721012545
npx supabase migration repair --status reverted 20250721012619
npx supabase migration repair --status reverted 20250721013543
npx supabase migration repair --status reverted 20250721013643
npx supabase migration repair --status reverted 20250721053655
npx supabase migration repair --status reverted 20250721065317
npx supabase migration repair --status reverted 20250721065633
npx supabase migration repair --status reverted 20250721070458
npx supabase migration repair --status reverted 20250721070952
npx supabase migration repair --status reverted 20250721071007
npx supabase migration repair --status reverted 20250721071049
npx supabase migration repair --status reverted 20250721071104
npx supabase migration repair --status reverted 20250721071114
npx supabase migration repair --status reverted 20250721075030
npx supabase migration repair --status reverted 20250721082019
npx supabase migration repair --status reverted 20250724014214
npx supabase migration repair --status reverted 20250724050427
npx supabase migration repair --status reverted 20250729052032
npx supabase migration repair --status reverted 20250729060805
npx supabase migration repair --status reverted 20250811015512
npx supabase migration repair --status reverted 20250811015525
npx supabase migration repair --status reverted 20250811124648
npx supabase migration repair --status reverted 20250813025850
npx supabase migration repair --status reverted 20250817024818
npx supabase migration repair --status reverted 20250817024825
npx supabase migration repair --status reverted 20250817024831
npx supabase migration repair --status reverted 20250817024846
npx supabase migration repair --status reverted 20250817052421
npx supabase migration repair --status reverted 20250818063328

echo "Marking local migrations as applied..."
# Mark the local migrations as applied in correct order
npx supabase migration repair --status applied 20240118_contact_submissions_rate_limit
npx supabase migration repair --status applied 20250801000000_complete_schema
npx supabase migration repair --status applied 20250812_add_deposit_fields
npx supabase migration repair --status applied 20250813000000_add_is_facilitator_column
npx supabase migration repair --status applied 20250817183000_add_skill_level_to_payments
npx supabase migration repair --status applied 20250818000001_add_team_registration_to_leagues
npx supabase migration repair --status applied 20250818000002_add_league_ids_to_users
npx supabase migration repair --status applied 20250818000003_make_team_id_nullable_in_payments
npx supabase migration repair --status applied 20250818000004_migrate_badminton_registrations

echo "Done! Now run: npx supabase db push"